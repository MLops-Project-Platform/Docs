"use strict";(self.webpackChunkmlops_documentation=self.webpackChunkmlops_documentation||[]).push([[27],{1404:function(e,n,r){r.r(n),r.d(n,{assets:function(){return a},contentTitle:function(){return l},default:function(){return m},frontMatter:function(){return t},metadata:function(){return i},toc:function(){return c}});var i=JSON.parse('{"id":"tools/docker","title":"Docker","description":"What is Docker?","source":"@site/docs/tools/docker.md","sourceDirName":"tools","slug":"/tools/docker","permalink":"/docs/tools/docker","draft":false,"unlisted":false,"editUrl":"https://github.com/MLops-Project-Platform/documentation/tree/main/docs/tools/docker.md","tags":[],"version":"current","sidebarPosition":5,"frontMatter":{"sidebar_position":5},"sidebar":"tutorialSidebar","previous":{"title":"MLflow","permalink":"/docs/tools/mlflow"},"next":{"title":"Kubernetes","permalink":"/docs/tools/kubernetes"}}'),o=r(4848),s=r(8453);const t={sidebar_position:5},l="Docker",a={},c=[{value:"What is Docker?",id:"what-is-docker",level:2},{value:"Role in MLOps Platform",id:"role-in-mlops-platform",level:2},{value:"Key Concepts",id:"key-concepts",level:2},{value:"Images",id:"images",level:3},{value:"Containers",id:"containers",level:3},{value:"docker-compose",id:"docker-compose",level:3},{value:"Local Development",id:"local-development",level:2},{value:"Start Platform",id:"start-platform",level:3},{value:"View Status",id:"view-status",level:3},{value:"Enter Container",id:"enter-container",level:3},{value:"Working with Images",id:"working-with-images",level:2},{value:"Build Custom Image",id:"build-custom-image",level:3},{value:"Push to Registry",id:"push-to-registry",level:3},{value:"List Images",id:"list-images",level:3},{value:"docker-compose Configuration",id:"docker-compose-configuration",level:2},{value:"Example: MLflow Service",id:"example-mlflow-service",level:3},{value:"Common Docker Commands",id:"common-docker-commands",level:2},{value:"Best Practices",id:"best-practices",level:2},{value:"Performance Optimization",id:"performance-optimization",level:2},{value:"Multi-stage Build",id:"multi-stage-build",level:3},{value:"Caching Optimization",id:"caching-optimization",level:3},{value:"Troubleshooting",id:"troubleshooting",level:2},{value:"Out of Disk Space",id:"out-of-disk-space",level:3},{value:"Port Already in Use",id:"port-already-in-use",level:3},{value:"Container Won&#39;t Start",id:"container-wont-start",level:3}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.header,{children:(0,o.jsx)(n.h1,{id:"docker",children:"Docker"})}),"\n",(0,o.jsx)(n.h2,{id:"what-is-docker",children:"What is Docker?"}),"\n",(0,o.jsx)(n.p,{children:"Docker is a containerization platform that packages applications with all their dependencies into isolated containers, ensuring consistency across development, testing, and production environments."}),"\n",(0,o.jsx)(n.h2,{id:"role-in-mlops-platform",children:"Role in MLOps Platform"}),"\n",(0,o.jsx)(n.p,{children:"Docker is used for:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Development"})," - Local testing with exact production environment"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Distribution"})," - Ship code and dependencies together"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"MLflow Server"})," - Run MLflow in container"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Training Jobs"})," - Containerized training workloads"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Custom Services"})," - Any additional microservices"]}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"key-concepts",children:"Key Concepts"}),"\n",(0,o.jsx)(n.h3,{id:"images",children:"Images"}),"\n",(0,o.jsx)(n.p,{children:"Blueprint for containers. Contains application code and dependencies."}),"\n",(0,o.jsx)(n.h3,{id:"containers",children:"Containers"}),"\n",(0,o.jsx)(n.p,{children:"Running instance of an image. Isolated from host system."}),"\n",(0,o.jsx)(n.h3,{id:"docker-compose",children:"docker-compose"}),"\n",(0,o.jsx)(n.p,{children:"Tool for defining and running multi-container applications."}),"\n",(0,o.jsx)(n.h2,{id:"local-development",children:"Local Development"}),"\n",(0,o.jsx)(n.h3,{id:"start-platform",children:"Start Platform"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"cd mlops-platform/docker-compose\r\ndocker compose up -d\n"})}),"\n",(0,o.jsx)(n.p,{children:"This starts:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"MLflow tracking server"}),"\n",(0,o.jsx)(n.li,{children:"PostgreSQL database"}),"\n",(0,o.jsx)(n.li,{children:"MinIO object storage"}),"\n",(0,o.jsx)(n.li,{children:"Nginx reverse proxy"}),"\n"]}),"\n",(0,o.jsx)(n.h3,{id:"view-status",children:"View Status"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"# List running containers\r\ndocker compose ps\r\n\r\n# View container logs\r\ndocker compose logs -f mlflow\r\n\r\n# View specific service logs\r\ndocker compose logs mlflow postgres minio\n"})}),"\n",(0,o.jsx)(n.h3,{id:"enter-container",children:"Enter Container"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"# Access MLflow container\r\ndocker compose exec mlflow bash\r\n\r\n# Access PostgreSQL container\r\ndocker compose exec postgres bash\r\n\r\n# Access MinIO container\r\ndocker compose exec minio bash\n"})}),"\n",(0,o.jsx)(n.h2,{id:"working-with-images",children:"Working with Images"}),"\n",(0,o.jsx)(n.h3,{id:"build-custom-image",children:"Build Custom Image"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-dockerfile",children:'FROM python:3.10\r\n\r\nWORKDIR /app\r\n\r\n# Copy requirements\r\nCOPY requirements.txt .\r\n\r\n# Install dependencies\r\nRUN pip install -r requirements.txt\r\n\r\n# Copy application code\r\nCOPY . .\r\n\r\n# Define entry point\r\nCMD ["python", "train.py"]\n'})}),"\n",(0,o.jsx)(n.p,{children:"Build the image:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"docker build -t my-mlops-trainer:1.0 .\n"})}),"\n",(0,o.jsx)(n.h3,{id:"push-to-registry",children:"Push to Registry"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"# Tag for registry\r\ndocker tag my-mlops-trainer:1.0 myregistry.azurecr.io/my-mlops-trainer:1.0\r\n\r\n# Login to registry (e.g., Azure Container Registry)\r\naz acr login --name myregistry\r\n\r\n# Push image\r\ndocker push myregistry.azurecr.io/my-mlops-trainer:1.0\n"})}),"\n",(0,o.jsx)(n.h3,{id:"list-images",children:"List Images"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:'# List all images\r\ndocker image ls\r\n\r\n# List with filter\r\ndocker image ls --filter "reference=*mlops*"\r\n\r\n# Get image details\r\ndocker image inspect my-mlops-trainer:1.0\n'})}),"\n",(0,o.jsx)(n.h2,{id:"docker-compose-configuration",children:"docker-compose Configuration"}),"\n",(0,o.jsx)(n.h3,{id:"example-mlflow-service",children:"Example: MLflow Service"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-yaml",children:'version: \'3.8\'\r\n\r\nservices:\r\n  mlflow:\r\n    image: python:3.10\r\n    container_name: mlflow-server\r\n    \r\n    environment:\r\n      MLFLOW_BACKEND_STORE_URI: postgresql://mlflow:mlflow@postgres:5432/mlflow\r\n      MLFLOW_DEFAULT_ARTIFACT_ROOT: s3://mlflow-artifacts\r\n      AWS_ACCESS_KEY_ID: minioadmin\r\n      AWS_SECRET_ACCESS_KEY: minioadmin123\r\n    \r\n    ports:\r\n      - "5000:5000"\r\n    \r\n    depends_on:\r\n      - postgres\r\n      - minio\r\n    \r\n    command: |\r\n      bash -c "pip install mlflow &&\r\n               mlflow server --backend-store-uri postgresql://mlflow:mlflow@postgres:5432/mlflow \\\r\n                            --default-artifact-root s3://mlflow-artifacts \\\r\n                            --host 0.0.0.0 --port 5000"\r\n\r\n  postgres:\r\n    image: postgres:14\r\n    container_name: mlflow-postgres\r\n    \r\n    environment:\r\n      POSTGRES_USER: mlflow\r\n      POSTGRES_PASSWORD: mlflow\r\n      POSTGRES_DB: mlflow\r\n    \r\n    ports:\r\n      - "5432:5432"\r\n    \r\n    volumes:\r\n      - postgres_data:/var/lib/postgresql/data\r\n\r\n  minio:\r\n    image: minio/minio:latest\r\n    container_name: mlflow-minio\r\n    \r\n    environment:\r\n      MINIO_ROOT_USER: minioadmin\r\n      MINIO_ROOT_PASSWORD: minioadmin123\r\n    \r\n    ports:\r\n      - "9000:9000"\r\n      - "9001:9001"\r\n    \r\n    volumes:\r\n      - minio_data:/data\r\n    \r\n    command: server /data --console-address ":9001"\r\n\r\nvolumes:\r\n  postgres_data:\r\n  minio_data:\n'})}),"\n",(0,o.jsx)(n.h2,{id:"common-docker-commands",children:"Common Docker Commands"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"# Container Management\r\ndocker compose up              # Start services\r\ndocker compose up -d           # Start in background\r\ndocker compose down            # Stop services\r\ndocker compose restart         # Restart services\r\ndocker compose logs -f         # View logs (follow)\r\n\r\n# Cleanup\r\ndocker compose down -v         # Remove volumes too\r\ndocker system prune            # Remove unused resources\r\n\r\n# Debugging\r\ndocker compose ps              # List services\r\ndocker compose exec <svc> bash # Enter container\r\ndocker compose logs <svc>      # View service logs\r\ndocker compose inspect <svc>   # Show configuration\n"})}),"\n",(0,o.jsx)(n.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,o.jsxs)(n.p,{children:["\u2705 ",(0,o.jsx)(n.strong,{children:"Do:"})]}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"Use specific version tags (not latest)"}),"\n",(0,o.jsx)(n.li,{children:"Keep images small and efficient"}),"\n",(0,o.jsx)(n.li,{children:"Layer properly for caching"}),"\n",(0,o.jsx)(n.li,{children:"Use .dockerignore file"}),"\n",(0,o.jsx)(n.li,{children:"Run as non-root user"}),"\n",(0,o.jsx)(n.li,{children:"Health checks"}),"\n"]}),"\n",(0,o.jsxs)(n.p,{children:["\u274c ",(0,o.jsx)(n.strong,{children:"Don't:"})]}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"Use latest tag in production"}),"\n",(0,o.jsx)(n.li,{children:"Store credentials in images"}),"\n",(0,o.jsx)(n.li,{children:"Run containers as root"}),"\n",(0,o.jsx)(n.li,{children:"Create huge layers"}),"\n",(0,o.jsx)(n.li,{children:"Ignore security warnings"}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"performance-optimization",children:"Performance Optimization"}),"\n",(0,o.jsx)(n.h3,{id:"multi-stage-build",children:"Multi-stage Build"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-dockerfile",children:'# Build stage\r\nFROM python:3.10 as builder\r\n\r\nWORKDIR /app\r\nCOPY requirements.txt .\r\nRUN pip install --user -r requirements.txt\r\n\r\n# Final stage (smaller image)\r\nFROM python:3.10-slim\r\n\r\nCOPY --from=builder /root/.local /root/.local\r\nCOPY . /app\r\n\r\nENV PATH=/root/.local/bin:$PATH\r\nWORKDIR /app\r\n\r\nCMD ["python", "train.py"]\n'})}),"\n",(0,o.jsx)(n.h3,{id:"caching-optimization",children:"Caching Optimization"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-dockerfile",children:'# Put frequently changing lines last\r\nFROM python:3.10\r\n\r\nWORKDIR /app\r\n\r\n# Install dependencies first (cached)\r\nCOPY requirements.txt .\r\nRUN pip install -r requirements.txt\r\n\r\n# Copy code last (changes frequently)\r\nCOPY . .\r\n\r\nCMD ["python", "train.py"]\n'})}),"\n",(0,o.jsx)(n.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,o.jsx)(n.h3,{id:"out-of-disk-space",children:"Out of Disk Space"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"# Check disk usage\r\ndocker system df\r\n\r\n# Clean up\r\ndocker system prune -a  # Remove unused images\r\n\r\n# Remove specific image\r\ndocker rmi <image-id>\n"})}),"\n",(0,o.jsx)(n.h3,{id:"port-already-in-use",children:"Port Already in Use"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:'# Check what\'s using port\r\nnetstat -ano | findstr :5000  # Windows\r\nlsof -i :5000                 # Mac/Linux\r\n\r\n# Change port in docker-compose.yml\r\nports:\r\n  - "5001:5000"  # Host:Container\n'})}),"\n",(0,o.jsx)(n.h3,{id:"container-wont-start",children:"Container Won't Start"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"# Check logs\r\ndocker compose logs mlflow\r\n\r\n# Check image\r\ndocker image inspect <image>\r\n\r\n# Validate configuration\r\ndocker compose config\n"})}),"\n",(0,o.jsx)(n.hr,{}),"\n",(0,o.jsxs)(n.p,{children:["See ",(0,o.jsx)(n.a,{href:"/docs/researcher-guide/training",children:"Training Guide"})," for containerizing training code."]})]})}function m(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(d,{...e})}):d(e)}},8453:function(e,n,r){r.d(n,{R:function(){return t},x:function(){return l}});var i=r(6540);const o={},s=i.createContext(o);function t(e){const n=i.useContext(s);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:t(e.components),i.createElement(s.Provider,{value:n},e.children)}}}]);