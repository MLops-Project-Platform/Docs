"use strict";(self.webpackChunkmlops_documentation=self.webpackChunkmlops_documentation||[]).push([[2532],{3656:function(e,n,r){r.r(n),r.d(n,{assets:function(){return l},contentTitle:function(){return i},default:function(){return d},frontMatter:function(){return s},metadata:function(){return a},toc:function(){return c}});var a=JSON.parse('{"id":"tools/argocd","title":"ArgoCD - GitOps for Kubernetes","description":"Overview","source":"@site/docs/tools/argocd.md","sourceDirName":"tools","slug":"/tools/argocd","permalink":"/docs/tools/argocd","draft":false,"unlisted":false,"editUrl":"https://github.com/MLops-Project-Platform/documentation/tree/main/docs/tools/argocd.md","tags":[],"version":"current","sidebarPosition":7,"frontMatter":{"sidebar_position":7},"sidebar":"tutorialSidebar","previous":{"title":"Helm Charts & Package Management","permalink":"/docs/tools/helm"},"next":{"title":"NVIDIA GPU Scheduling","permalink":"/docs/tools/gpu-scheduling"}}'),t=r(4848),o=r(8453);const s={sidebar_position:7},i="ArgoCD - GitOps for Kubernetes",l={},c=[{value:"Overview",id:"overview",level:2},{value:"Core Concepts",id:"core-concepts",level:2},{value:"GitOps Workflow",id:"gitops-workflow",level:3},{value:"Application CRD",id:"application-crd",level:3},{value:"Installation",id:"installation",level:2},{value:"Install ArgoCD",id:"install-argocd",level:3},{value:"Application Management",id:"application-management",level:2},{value:"Create Application via CLI",id:"create-application-via-cli",level:3},{value:"Create Application from YAML",id:"create-application-from-yaml",level:3},{value:"Sync Applications",id:"sync-applications",level:3},{value:"Multi-Environment Setup",id:"multi-environment-setup",level:2},{value:"App of Apps Pattern",id:"app-of-apps-pattern",level:3},{value:"Directory Structure",id:"directory-structure",level:3},{value:"Environment-specific Applications",id:"environment-specific-applications",level:3},{value:"Notifications",id:"notifications",level:2},{value:"GitHub Integration",id:"github-integration",level:3},{value:"Slack Notifications",id:"slack-notifications",level:3},{value:"RBAC and Access Control",id:"rbac-and-access-control",level:2},{value:"Create Project with RBAC",id:"create-project-with-rbac",level:3},{value:"Advanced Features",id:"advanced-features",level:2},{value:"Kustomize Integration",id:"kustomize-integration",level:3},{value:"Helm Values Override",id:"helm-values-override",level:3},{value:"Health Assessment",id:"health-assessment",level:3},{value:"Troubleshooting",id:"troubleshooting",level:2},{value:"Check Application Status",id:"check-application-status",level:3},{value:"Sync Status",id:"sync-status",level:3},{value:"View Diff",id:"view-diff",level:3},{value:"Best Practices",id:"best-practices",level:2},{value:"Further Reading",id:"further-reading",level:2}];function p(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"argocd---gitops-for-kubernetes",children:"ArgoCD - GitOps for Kubernetes"})}),"\n",(0,t.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,t.jsx)(n.p,{children:"ArgoCD is a declarative, GitOps continuous deployment tool for Kubernetes. It synchronizes your cluster with Git repositories to maintain desired state."}),"\n",(0,t.jsx)(n.h2,{id:"core-concepts",children:"Core Concepts"}),"\n",(0,t.jsx)(n.h3,{id:"gitops-workflow",children:"GitOps Workflow"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"Git Repository (Source of Truth)\r\n         \u2193\r\n    ArgoCD\r\n         \u2193\r\nKubernetes Cluster (Actual State)\r\n         \u2193\r\n    Monitoring\r\n         \u2193\r\nIf Drift Detected \u2192 Sync\n"})}),"\n",(0,t.jsx)(n.h3,{id:"application-crd",children:"Application CRD"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"apiVersion: argoproj.io/v1alpha1\r\nkind: Application\r\nmetadata:\r\n  name: mlops-platform\r\n  namespace: argocd\r\nspec:\r\n  project: default\r\n  source:\r\n    repoURL: https://github.com/MLops-Project-Platform/mlops-deployment\r\n    targetRevision: main\r\n    path: helm/mlops\r\n    helm:\r\n      values: |\r\n        replicaCount: 3\r\n  destination:\r\n    server: https://kubernetes.default.svc\r\n    namespace: mlops-prod\r\n  syncPolicy:\r\n    automated:\r\n      prune: true\r\n      selfHeal: true\r\n    syncOptions:\r\n    - CreateNamespace=true\n"})}),"\n",(0,t.jsx)(n.h2,{id:"installation",children:"Installation"}),"\n",(0,t.jsx)(n.h3,{id:"install-argocd",children:"Install ArgoCD"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'# Create namespace\r\nkubectl create namespace argocd\r\n\r\n# Install ArgoCD\r\nkubectl apply -n argocd -f https://raw.githubusercontent.com/argoproj/argo-cd/stable/manifests/install.yaml\r\n\r\n# Wait for deployment\r\nkubectl wait --for=condition=ready pod -l app.kubernetes.io/name=argocd-server -n argocd --timeout=300s\r\n\r\n# Port forward to access UI\r\nkubectl port-forward svc/argocd-server -n argocd 8080:443\r\n\r\n# Get initial admin password\r\nkubectl -n argocd get secret argocd-initial-admin-secret -o jsonpath="{.data.password}" | base64 -d\n'})}),"\n",(0,t.jsx)(n.h2,{id:"application-management",children:"Application Management"}),"\n",(0,t.jsx)(n.h3,{id:"create-application-via-cli",children:"Create Application via CLI"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"argocd login localhost:8080 --username admin\r\n\r\nargocd app create mlops-platform \\\r\n  --repo https://github.com/MLops-Project-Platform/mlops-deployment \\\r\n  --revision main \\\r\n  --path helm/mlops \\\r\n  --dest-server https://kubernetes.default.svc \\\r\n  --dest-namespace mlops-prod\n"})}),"\n",(0,t.jsx)(n.h3,{id:"create-application-from-yaml",children:"Create Application from YAML"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"apiVersion: argoproj.io/v1alpha1\r\nkind: Application\r\nmetadata:\r\n  name: mlops-platform\r\n  namespace: argocd\r\nspec:\r\n  project: default\r\n  source:\r\n    repoURL: https://github.com/MLops-Project-Platform/mlops-deployment\r\n    targetRevision: main\r\n    path: helm/mlops\r\n  destination:\r\n    server: https://kubernetes.default.svc\r\n    namespace: mlops-prod\r\n  syncPolicy:\r\n    automated:\r\n      prune: true\r\n      selfHeal: true\n"})}),"\n",(0,t.jsx)(n.h3,{id:"sync-applications",children:"Sync Applications"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# Manual sync\r\nargocd app sync mlops-platform\r\n\r\n# Sync with info\r\nargocd app sync mlops-platform --info\r\n\r\n# Sync specific resource\r\nargocd app sync mlops-platform --resource deployment:mlflow\r\n\r\n# Refresh application status\r\nargocd app refresh mlops-platform\n"})}),"\n",(0,t.jsx)(n.h2,{id:"multi-environment-setup",children:"Multi-Environment Setup"}),"\n",(0,t.jsx)(n.h3,{id:"app-of-apps-pattern",children:"App of Apps Pattern"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"apiVersion: argoproj.io/v1alpha1\r\nkind: Application\r\nmetadata:\r\n  name: mlops-root\r\n  namespace: argocd\r\nspec:\r\n  project: default\r\n  source:\r\n    repoURL: https://github.com/MLops-Project-Platform/mlops-deployment\r\n    targetRevision: main\r\n    path: argocd/apps\r\n  destination:\r\n    server: https://kubernetes.default.svc\r\n    namespace: argocd\r\n  syncPolicy:\r\n    automated:\r\n      prune: true\r\n      selfHeal: true\n"})}),"\n",(0,t.jsx)(n.h3,{id:"directory-structure",children:"Directory Structure"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"mlops-deployment/\r\n\u251c\u2500\u2500 argocd/\r\n\u2502   \u2514\u2500\u2500 apps/\r\n\u2502       \u251c\u2500\u2500 dev.yaml\r\n\u2502       \u251c\u2500\u2500 qa.yaml\r\n\u2502       \u2514\u2500\u2500 prod.yaml\r\n\u251c\u2500\u2500 helm/\r\n\u2502   \u2514\u2500\u2500 mlops/\r\n\u2502       \u251c\u2500\u2500 Chart.yaml\r\n\u2502       \u251c\u2500\u2500 values-dev.yaml\r\n\u2502       \u251c\u2500\u2500 values-qa.yaml\r\n\u2502       \u2514\u2500\u2500 values-prod.yaml\r\n\u2514\u2500\u2500 k8s/\r\n    \u251c\u2500\u2500 base/\r\n    \u2502   \u2514\u2500\u2500 kustomization.yaml\r\n    \u2514\u2500\u2500 overlays/\r\n        \u251c\u2500\u2500 dev/\r\n        \u251c\u2500\u2500 qa/\r\n        \u2514\u2500\u2500 prod/\n"})}),"\n",(0,t.jsx)(n.h3,{id:"environment-specific-applications",children:"Environment-specific Applications"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"# dev.yaml\r\napiVersion: argoproj.io/v1alpha1\r\nkind: Application\r\nmetadata:\r\n  name: mlops-dev\r\n  namespace: argocd\r\nspec:\r\n  source:\r\n    repoURL: https://github.com/MLops-Project-Platform/mlops-deployment\r\n    targetRevision: dev\r\n    path: helm/mlops\r\n    helm:\r\n      valuesFiles:\r\n      - values-dev.yaml\r\n  destination:\r\n    namespace: mlops-dev\r\n\r\n---\r\n# qa.yaml\r\napiVersion: argoproj.io/v1alpha1\r\nkind: Application\r\nmetadata:\r\n  name: mlops-qa\r\n  namespace: argocd\r\nspec:\r\n  source:\r\n    repoURL: https://github.com/MLops-Project-Platform/mlops-deployment\r\n    targetRevision: qa\r\n    path: helm/mlops\r\n    helm:\r\n      valuesFiles:\r\n      - values-qa.yaml\r\n  destination:\r\n    namespace: mlops-qa\r\n\r\n---\r\n# prod.yaml\r\napiVersion: argoproj.io/v1alpha1\r\nkind: Application\r\nmetadata:\r\n  name: mlops-prod\r\n  namespace: argocd\r\nspec:\r\n  source:\r\n    repoURL: https://github.com/MLops-Project-Platform/mlops-deployment\r\n    targetRevision: main\r\n    path: helm/mlops\r\n    helm:\r\n      valuesFiles:\r\n      - values-prod.yaml\r\n  destination:\r\n    namespace: mlops-prod\r\n  syncPolicy:\r\n    automated:\r\n      prune: true\r\n      selfHeal: true\r\n    syncOptions:\r\n    - PruneLast=true\n"})}),"\n",(0,t.jsx)(n.h2,{id:"notifications",children:"Notifications"}),"\n",(0,t.jsx)(n.h3,{id:"github-integration",children:"GitHub Integration"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# Create GitHub OAuth token\r\n# Add webhook to ArgoCD in GitHub settings\r\n\r\n# Configure ArgoCD notification\r\nkubectl create secret generic argocd-notifications-secret \\\r\n  --from-literal=github-token=<token> \\\r\n  -n argocd\n"})}),"\n",(0,t.jsx)(n.h3,{id:"slack-notifications",children:"Slack Notifications"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"apiVersion: v1\r\nkind: ConfigMap\r\nmetadata:\r\n  name: argocd-notifications-cm\r\n  namespace: argocd\r\ndata:\r\n  slack.yaml: |\r\n    token: $slack-token\r\n  template.yaml: |\r\n    - name: app-deployed\r\n      message: \"Application {{.app.metadata.name}} deployed successfully\"\r\n  trigger.yaml: |\r\n    - name: on-app-deployed\r\n      - when: app.status.operationState.phase in ['Succeeded']\r\n        oncePer: app.status.operationState.startedAt\r\n        send: [app-deployed]\n"})}),"\n",(0,t.jsx)(n.h2,{id:"rbac-and-access-control",children:"RBAC and Access Control"}),"\n",(0,t.jsx)(n.h3,{id:"create-project-with-rbac",children:"Create Project with RBAC"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"apiVersion: argoproj.io/v1alpha1\r\nkind: AppProject\r\nmetadata:\r\n  name: mlops-team\r\n  namespace: argocd\r\nspec:\r\n  sourceRepos:\r\n  - https://github.com/MLops-Project-Platform/*\r\n  destinations:\r\n  - namespace: 'mlops-*'\r\n    server: https://kubernetes.default.svc\r\n  clusterResourceBlacklist:\r\n  - group: ''\r\n    kind: ResourceQuota\r\n  - group: ''\r\n    kind: NetworkPolicy\n"})}),"\n",(0,t.jsx)(n.h2,{id:"advanced-features",children:"Advanced Features"}),"\n",(0,t.jsx)(n.h3,{id:"kustomize-integration",children:"Kustomize Integration"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"argocd app create mlops-kustomize \\\r\n  --repo https://github.com/MLops-Project-Platform/mlops-deployment \\\r\n  --revision main \\\r\n  --path k8s/overlays/prod \\\r\n  --dest-server https://kubernetes.default.svc \\\r\n  --dest-namespace mlops-prod\n"})}),"\n",(0,t.jsx)(n.h3,{id:"helm-values-override",children:"Helm Values Override"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"argocd app set mlops-platform \\\r\n  --helm-set-string image.tag=v2.0 \\\r\n  --helm-set replicaCount=5\n"})}),"\n",(0,t.jsx)(n.h3,{id:"health-assessment",children:"Health Assessment"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"argocd app wait mlops-platform --health\n"})}),"\n",(0,t.jsx)(n.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,t.jsx)(n.h3,{id:"check-application-status",children:"Check Application Status"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"argocd app get mlops-platform\r\nargocd app logs mlops-platform\n"})}),"\n",(0,t.jsx)(n.h3,{id:"sync-status",children:"Sync Status"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"argocd app sync mlops-platform --info\r\nargocd app wait mlops-platform --sync\n"})}),"\n",(0,t.jsx)(n.h3,{id:"view-diff",children:"View Diff"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"argocd app diff mlops-platform\n"})}),"\n",(0,t.jsx)(n.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Git as Source of Truth"})," - All configuration in Git"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Automated Sync"})," - Enable ",(0,t.jsx)(n.code,{children:"automated.prune"})," and ",(0,t.jsx)(n.code,{children:"selfHeal"})]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"GitOps Workflow"})," - Create PRs for infrastructure changes"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Application of Applications"})," - Use App of Apps pattern for multi-env"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"RBAC"})," - Implement proper access control"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Notifications"})," - Set up alerts for sync failures"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Backups"})," - Backup ArgoCD configuration and CRDs"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"further-reading",children:"Further Reading"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://argo-cd.readthedocs.io/",children:"ArgoCD Official Documentation"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://codefresh.io/gitops/",children:"GitOps Best Practices"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://github.com/argoproj-labs/argocd-patterns",children:"ArgoCD Patterns"})}),"\n"]})]})}function d(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(p,{...e})}):p(e)}},8453:function(e,n,r){r.d(n,{R:function(){return s},x:function(){return i}});var a=r(6540);const t={},o=a.createContext(t);function s(e){const n=a.useContext(o);return a.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:s(e.components),a.createElement(o.Provider,{value:n},e.children)}}}]);