"use strict";(self.webpackChunkmlops_documentation=self.webpackChunkmlops_documentation||[]).push([[1968],{4137:function(e,n,r){r.r(n),r.d(n,{assets:function(){return c},contentTitle:function(){return o},default:function(){return p},frontMatter:function(){return t},metadata:function(){return s},toc:function(){return i}});var s=JSON.parse('{"id":"deployment/kubernetes","title":"Kubernetes Deployment","description":"Deploy the MLOps Platform documentation to Kubernetes.","source":"@site/docs/deployment/kubernetes.md","sourceDirName":"deployment","slug":"/deployment/kubernetes","permalink":"/docs/deployment/kubernetes","draft":false,"unlisted":false,"editUrl":"https://github.com/MLops-Project-Platform/documentation/tree/main/docs/deployment/kubernetes.md","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2}}'),l=r(4848),a=r(8453);const t={sidebar_position:2},o="Kubernetes Deployment",c={},i=[{value:"Prerequisites",id:"prerequisites",level:2},{value:"Using kubectl",id:"using-kubectl",level:2},{value:"Create Namespace",id:"create-namespace",level:3},{value:"Create Deployment",id:"create-deployment",level:3},{value:"Create Service",id:"create-service",level:3},{value:"Create Ingress",id:"create-ingress",level:3},{value:"Create Service Account (Optional)",id:"create-service-account-optional",level:3},{value:"Using Helm",id:"using-helm",level:2},{value:"Create Helm Chart",id:"create-helm-chart",level:3},{value:"Chart.yaml",id:"chartyaml",level:3},{value:"values.yaml",id:"valuesyaml",level:3},{value:"templates/deployment.yaml",id:"templatesdeploymentyaml",level:3},{value:"Install with Helm",id:"install-with-helm",level:3},{value:"Verification",id:"verification",level:2},{value:"Check Deployment Status",id:"check-deployment-status",level:3},{value:"View Logs",id:"view-logs",level:3},{value:"Port Forwarding (Testing)",id:"port-forwarding-testing",level:3},{value:"Scaling",id:"scaling",level:2},{value:"Manual Scaling",id:"manual-scaling",level:3},{value:"Auto-scaling",id:"auto-scaling",level:3},{value:"Monitoring",id:"monitoring",level:2},{value:"Prometheus Metrics",id:"prometheus-metrics",level:3},{value:"View Metrics",id:"view-metrics",level:3},{value:"Troubleshooting",id:"troubleshooting",level:2},{value:"Pod Won&#39;t Start",id:"pod-wont-start",level:3},{value:"Service Not Accessible",id:"service-not-accessible",level:3},{value:"Ingress Issues",id:"ingress-issues",level:3},{value:"Advanced: GitOps with ArgoCD",id:"advanced-gitops-with-argocd",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",ul:"ul",...(0,a.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.header,{children:(0,l.jsx)(n.h1,{id:"kubernetes-deployment",children:"Kubernetes Deployment"})}),"\n",(0,l.jsx)(n.p,{children:"Deploy the MLOps Platform documentation to Kubernetes."}),"\n",(0,l.jsx)(n.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Kubernetes cluster (1.20+)"}),"\n",(0,l.jsx)(n.li,{children:"kubectl configured"}),"\n",(0,l.jsx)(n.li,{children:"Helm 3.x (optional)"}),"\n",(0,l.jsx)(n.li,{children:"Container registry access (Docker Hub, ACR, ECR, etc.)"}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"using-kubectl",children:"Using kubectl"}),"\n",(0,l.jsx)(n.h3,{id:"create-namespace",children:"Create Namespace"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-yaml",children:"# k8s/namespace.yaml\r\napiVersion: v1\r\nkind: Namespace\r\nmetadata:\r\n  name: mlops-docs\n"})}),"\n",(0,l.jsx)(n.p,{children:"Apply:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"kubectl apply -f k8s/namespace.yaml\n"})}),"\n",(0,l.jsx)(n.h3,{id:"create-deployment",children:"Create Deployment"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-yaml",children:'# k8s/deployment.yaml\r\napiVersion: apps/v1\r\nkind: Deployment\r\nmetadata:\r\n  name: mlops-docs\r\n  namespace: mlops-docs\r\n  labels:\r\n    app: mlops-docs\r\nspec:\r\n  replicas: 3\r\n  \r\n  strategy:\r\n    type: RollingUpdate\r\n    rollingUpdate:\r\n      maxSurge: 1\r\n      maxUnavailable: 0\r\n  \r\n  selector:\r\n    matchLabels:\r\n      app: mlops-docs\r\n  \r\n  template:\r\n    metadata:\r\n      labels:\r\n        app: mlops-docs\r\n      annotations:\r\n        prometheus.io/scrape: "true"\r\n        prometheus.io/port: "3000"\r\n    \r\n    spec:\r\n      serviceAccountName: mlops-docs\r\n      \r\n      securityContext:\r\n        fsGroup: 1001\r\n      \r\n      containers:\r\n      - name: docs\r\n        image: your-registry/mlops-docs:1.0\r\n        imagePullPolicy: IfNotPresent\r\n        \r\n        ports:\r\n        - name: http\r\n          containerPort: 3000\r\n          protocol: TCP\r\n        \r\n        env:\r\n        - name: NODE_ENV\r\n          value: production\r\n        \r\n        resources:\r\n          requests:\r\n            memory: "128Mi"\r\n            cpu: "100m"\r\n          limits:\r\n            memory: "512Mi"\r\n            cpu: "500m"\r\n        \r\n        livenessProbe:\r\n          httpGet:\r\n            path: /\r\n            port: http\r\n          initialDelaySeconds: 30\r\n          periodSeconds: 10\r\n          timeoutSeconds: 5\r\n          failureThreshold: 3\r\n        \r\n        readinessProbe:\r\n          httpGet:\r\n            path: /\r\n            port: http\r\n          initialDelaySeconds: 10\r\n          periodSeconds: 5\r\n          timeoutSeconds: 3\r\n          failureThreshold: 2\r\n        \r\n        securityContext:\r\n          runAsNonRoot: true\r\n          runAsUser: 1001\r\n          allowPrivilegeEscalation: false\r\n          capabilities:\r\n            drop:\r\n              - ALL\n'})}),"\n",(0,l.jsx)(n.p,{children:"Apply:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"kubectl apply -f k8s/deployment.yaml\n"})}),"\n",(0,l.jsx)(n.h3,{id:"create-service",children:"Create Service"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-yaml",children:"# k8s/service.yaml\r\napiVersion: v1\r\nkind: Service\r\nmetadata:\r\n  name: mlops-docs\r\n  namespace: mlops-docs\r\n  labels:\r\n    app: mlops-docs\r\nspec:\r\n  type: LoadBalancer\r\n  \r\n  ports:\r\n  - port: 80\r\n    targetPort: http\r\n    protocol: TCP\r\n    name: http\r\n  \r\n  selector:\r\n    app: mlops-docs\n"})}),"\n",(0,l.jsx)(n.p,{children:"Apply:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"kubectl apply -f k8s/service.yaml\n"})}),"\n",(0,l.jsx)(n.h3,{id:"create-ingress",children:"Create Ingress"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-yaml",children:'# k8s/ingress.yaml\r\napiVersion: networking.k8s.io/v1\r\nkind: Ingress\r\nmetadata:\r\n  name: mlops-docs\r\n  namespace: mlops-docs\r\n  annotations:\r\n    cert-manager.io/cluster-issuer: "letsencrypt-prod"\r\n    nginx.ingress.kubernetes.io/rewrite-target: /\r\nspec:\r\n  ingressClassName: nginx\r\n  \r\n  tls:\r\n  - hosts:\r\n    - docs.mlops.example.com\r\n    secretName: mlops-docs-tls\r\n  \r\n  rules:\r\n  - host: docs.mlops.example.com\r\n    http:\r\n      paths:\r\n      - path: /\r\n        pathType: Prefix\r\n        backend:\r\n          service:\r\n            name: mlops-docs\r\n            port:\r\n              number: 80\n'})}),"\n",(0,l.jsx)(n.p,{children:"Apply:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"kubectl apply -f k8s/ingress.yaml\n"})}),"\n",(0,l.jsx)(n.h3,{id:"create-service-account-optional",children:"Create Service Account (Optional)"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-yaml",children:"# k8s/serviceaccount.yaml\r\napiVersion: v1\r\nkind: ServiceAccount\r\nmetadata:\r\n  name: mlops-docs\r\n  namespace: mlops-docs\n"})}),"\n",(0,l.jsx)(n.h2,{id:"using-helm",children:"Using Helm"}),"\n",(0,l.jsx)(n.h3,{id:"create-helm-chart",children:"Create Helm Chart"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"mkdir -p mlops-docs-chart\r\ncd mlops-docs-chart\n"})}),"\n",(0,l.jsx)(n.h3,{id:"chartyaml",children:"Chart.yaml"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-yaml",children:'apiVersion: v2\r\nname: mlops-docs\r\ndescription: MLOps Platform Documentation\r\ntype: application\r\nversion: 1.0.0\r\nappVersion: "1.0"\r\n\r\nkeywords:\r\n  - documentation\r\n  - mlops\r\n  - docusaurus\r\n\r\nhome: https://github.com/MLops-Project-Platform\r\nsource:\r\n  - https://github.com/MLops-Project-Platform\r\n\r\nmaintainers:\r\n  - name: MLOps Team\r\n    email: team@mlops.example.com\n'})}),"\n",(0,l.jsx)(n.h3,{id:"valuesyaml",children:"values.yaml"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-yaml",children:'replicaCount: 3\r\n\r\nimage:\r\n  registry: your-registry\r\n  repository: mlops-docs\r\n  tag: "1.0"\r\n  pullPolicy: IfNotPresent\r\n\r\nimagePullSecrets: []\r\n\r\nservice:\r\n  type: LoadBalancer\r\n  port: 80\r\n  targetPort: 3000\r\n\r\ningress:\r\n  enabled: true\r\n  className: nginx\r\n  annotations:\r\n    cert-manager.io/cluster-issuer: "letsencrypt-prod"\r\n  \r\n  hosts:\r\n    - host: docs.mlops.example.com\r\n      paths:\r\n        - path: /\r\n          pathType: Prefix\r\n  \r\n  tls:\r\n    - secretName: mlops-docs-tls\r\n      hosts:\r\n        - docs.mlops.example.com\r\n\r\nresources:\r\n  requests:\r\n    memory: "128Mi"\r\n    cpu: "100m"\r\n  limits:\r\n    memory: "512Mi"\r\n    cpu: "500m"\r\n\r\nautoscaling:\r\n  enabled: true\r\n  minReplicas: 2\r\n  maxReplicas: 10\r\n  targetCPUUtilizationPercentage: 80\r\n  targetMemoryUtilizationPercentage: 80\r\n\r\nnodeSelector: {}\r\n\r\ntolerations: []\r\n\r\naffinity: {}\r\n\r\nnodeAffinity:\r\n  preferredDuringSchedulingIgnoredDuringExecution:\r\n    - weight: 100\r\n      preference:\r\n        matchExpressions:\r\n          - key: node-type\r\n            operator: In\r\n            values:\r\n              - documentation\n'})}),"\n",(0,l.jsx)(n.h3,{id:"templatesdeploymentyaml",children:"templates/deployment.yaml"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-yaml",children:'apiVersion: apps/v1\r\nkind: Deployment\r\nmetadata:\r\n  name: {{ include "mlops-docs.fullname" . }}\r\n  labels:\r\n    {{- include "mlops-docs.labels" . | nindent 4 }}\r\nspec:\r\n  {{- if not .Values.autoscaling.enabled }}\r\n  replicas: {{ .Values.replicaCount }}\r\n  {{- end }}\r\n  selector:\r\n    matchLabels:\r\n      {{- include "mlops-docs.selectorLabels" . | nindent 6 }}\r\n  template:\r\n    metadata:\r\n      labels:\r\n        {{- include "mlops-docs.selectorLabels" . | nindent 8 }}\r\n    spec:\r\n      containers:\r\n      - name: {{ .Chart.Name }}\r\n        image: "{{ .Values.image.registry }}/{{ .Values.image.repository }}:{{ .Values.image.tag }}"\r\n        imagePullPolicy: {{ .Values.image.pullPolicy }}\r\n        ports:\r\n        - name: http\r\n          containerPort: 3000\r\n          protocol: TCP\r\n        livenessProbe:\r\n          httpGet:\r\n            path: /\r\n            port: http\r\n          initialDelaySeconds: 30\r\n          periodSeconds: 10\r\n        readinessProbe:\r\n          httpGet:\r\n            path: /\r\n            port: http\r\n          initialDelaySeconds: 10\r\n          periodSeconds: 5\r\n        resources:\r\n          {{- toYaml .Values.resources | nindent 12 }}\n'})}),"\n",(0,l.jsx)(n.h3,{id:"install-with-helm",children:"Install with Helm"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"# Install\r\nhelm install mlops-docs ./mlops-docs-chart \\\r\n  --namespace mlops-docs \\\r\n  --create-namespace\r\n\r\n# Verify\r\nhelm list -n mlops-docs\r\n\r\n# Upgrade\r\nhelm upgrade mlops-docs ./mlops-docs-chart -n mlops-docs\r\n\r\n# Uninstall\r\nhelm uninstall mlops-docs -n mlops-docs\n"})}),"\n",(0,l.jsx)(n.h2,{id:"verification",children:"Verification"}),"\n",(0,l.jsx)(n.h3,{id:"check-deployment-status",children:"Check Deployment Status"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"# Check pods\r\nkubectl get pods -n mlops-docs\r\n\r\n# Check services\r\nkubectl get svc -n mlops-docs\r\n\r\n# Check ingress\r\nkubectl get ingress -n mlops-docs\r\n\r\n# Describe deployment\r\nkubectl describe deployment mlops-docs -n mlops-docs\n"})}),"\n",(0,l.jsx)(n.h3,{id:"view-logs",children:"View Logs"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"# All pod logs\r\nkubectl logs -l app=mlops-docs -n mlops-docs -f\r\n\r\n# Specific pod\r\nkubectl logs pod/mlops-docs-xxxxx -n mlops-docs -f\n"})}),"\n",(0,l.jsx)(n.h3,{id:"port-forwarding-testing",children:"Port Forwarding (Testing)"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"# Forward to local port\r\nkubectl port-forward svc/mlops-docs 3000:80 -n mlops-docs\r\n\r\n# Access at http://localhost:3000\n"})}),"\n",(0,l.jsx)(n.h2,{id:"scaling",children:"Scaling"}),"\n",(0,l.jsx)(n.h3,{id:"manual-scaling",children:"Manual Scaling"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"# Scale replicas\r\nkubectl scale deployment mlops-docs --replicas=5 -n mlops-docs\r\n\r\n# Verify\r\nkubectl get pods -n mlops-docs -w\n"})}),"\n",(0,l.jsx)(n.h3,{id:"auto-scaling",children:"Auto-scaling"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-yaml",children:"# k8s/hpa.yaml\r\napiVersion: autoscaling/v2\r\nkind: HorizontalPodAutoscaler\r\nmetadata:\r\n  name: mlops-docs\r\n  namespace: mlops-docs\r\nspec:\r\n  scaleTargetRef:\r\n    apiVersion: apps/v1\r\n    kind: Deployment\r\n    name: mlops-docs\r\n  \r\n  minReplicas: 2\r\n  maxReplicas: 10\r\n  \r\n  metrics:\r\n  - type: Resource\r\n    resource:\r\n      name: cpu\r\n      target:\r\n        type: Utilization\r\n        averageUtilization: 70\r\n  \r\n  - type: Resource\r\n    resource:\r\n      name: memory\r\n      target:\r\n        type: Utilization\r\n        averageUtilization: 80\n"})}),"\n",(0,l.jsx)(n.h2,{id:"monitoring",children:"Monitoring"}),"\n",(0,l.jsx)(n.h3,{id:"prometheus-metrics",children:"Prometheus Metrics"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-yaml",children:"# k8s/servicemonitor.yaml\r\napiVersion: monitoring.coreos.com/v1\r\nkind: ServiceMonitor\r\nmetadata:\r\n  name: mlops-docs\r\n  namespace: mlops-docs\r\nspec:\r\n  selector:\r\n    matchLabels:\r\n      app: mlops-docs\r\n  \r\n  endpoints:\r\n  - port: http\r\n    interval: 30s\r\n    path: /metrics\n"})}),"\n",(0,l.jsx)(n.h3,{id:"view-metrics",children:"View Metrics"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"# Port forward to prometheus\r\nkubectl port-forward -n prometheus svc/prometheus 9090:9090\r\n\r\n# Access http://localhost:9090\n"})}),"\n",(0,l.jsx)(n.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,l.jsx)(n.h3,{id:"pod-wont-start",children:"Pod Won't Start"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"# Check pod status\r\nkubectl describe pod mlops-docs-xxxxx -n mlops-docs\r\n\r\n# View logs\r\nkubectl logs mlops-docs-xxxxx -n mlops-docs\r\n\r\n# Check image pull\r\nkubectl get events -n mlops-docs\n"})}),"\n",(0,l.jsx)(n.h3,{id:"service-not-accessible",children:"Service Not Accessible"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"# Check service\r\nkubectl get svc mlops-docs -n mlops-docs\r\n\r\n# Check endpoints\r\nkubectl get endpoints mlops-docs -n mlops-docs\r\n\r\n# Test pod\r\nkubectl exec -it mlops-docs-xxxxx -n mlops-docs -- wget localhost:3000\n"})}),"\n",(0,l.jsx)(n.h3,{id:"ingress-issues",children:"Ingress Issues"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"# Check ingress\r\nkubectl describe ingress mlops-docs -n mlops-docs\r\n\r\n# Check ingress controller\r\nkubectl get pods -n ingress-nginx\r\n\r\n# Check certificate\r\nkubectl get certificate -n mlops-docs\n"})}),"\n",(0,l.jsx)(n.h2,{id:"advanced-gitops-with-argocd",children:"Advanced: GitOps with ArgoCD"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-yaml",children:"# argocd-app.yaml\r\napiVersion: argoproj.io/v1alpha1\r\nkind: Application\r\nmetadata:\r\n  name: mlops-docs\r\n  namespace: argocd\r\nspec:\r\n  project: default\r\n  \r\n  source:\r\n    repoURL: https://github.com/MLops-Project-Platform/mlops-helm-charts\r\n    targetRevision: main\r\n    path: charts/docs\r\n  \r\n  destination:\r\n    server: https://kubernetes.default.svc\r\n    namespace: mlops-docs\r\n  \r\n  syncPolicy:\r\n    automated:\r\n      prune: true\r\n      selfHeal: true\r\n    syncOptions:\r\n    - CreateNamespace=true\n"})}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsxs)(n.p,{children:["Next: ",(0,l.jsx)(n.a,{href:"/docs/deployment/production-setup",children:"Production Setup \u2192"})]})]})}function p(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(d,{...e})}):d(e)}},8453:function(e,n,r){r.d(n,{R:function(){return t},x:function(){return o}});var s=r(6540);const l={},a=s.createContext(l);function t(e){const n=s.useContext(a);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:t(e.components),s.createElement(a.Provider,{value:n},e.children)}}}]);