"use strict";(self.webpackChunkmlops_documentation=self.webpackChunkmlops_documentation||[]).push([[8959],{261:function(n,e,r){r.r(e),r.d(e,{assets:function(){return l},contentTitle:function(){return a},default:function(){return u},frontMatter:function(){return t},metadata:function(){return s},toc:function(){return c}});var s=JSON.parse('{"id":"tools/mongodb","title":"MongoDB","description":"Overview","source":"@site/docs/tools/mongodb.md","sourceDirName":"tools","slug":"/tools/mongodb","permalink":"/docs/tools/mongodb","draft":false,"unlisted":false,"editUrl":"https://github.com/MLops-Project-Platform/documentation/tree/main/docs/tools/mongodb.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1},"sidebar":"tutorialSidebar","previous":{"title":"MySQL","permalink":"/docs/tools/mysql"},"next":{"title":"Apache Cassandra","permalink":"/docs/tools/cassandra"}}'),i=r(4848),o=r(8453);const t={sidebar_position:1},a="MongoDB",l={},c=[{value:"Overview",id:"overview",level:2},{value:"Key Features",id:"key-features",level:2},{value:"Use Cases in MLOps",id:"use-cases-in-mlops",level:2},{value:"Flexible Experiment Metadata",id:"flexible-experiment-metadata",level:3},{value:"Installation",id:"installation",level:2},{value:"Docker",id:"docker",level:3},{value:"Basic Operations",id:"basic-operations",level:2},{value:"CRUD Operations",id:"crud-operations",level:3},{value:"Indexing",id:"indexing",level:2},{value:"Aggregation Pipeline",id:"aggregation-pipeline",level:2},{value:"Transactions",id:"transactions",level:2},{value:"Monitoring",id:"monitoring",level:2},{value:"Backup and Recovery",id:"backup-and-recovery",level:2},{value:"Best Practices",id:"best-practices",level:2},{value:"Troubleshooting",id:"troubleshooting",level:2},{value:"Further Reading",id:"further-reading",level:2}];function d(n){const e={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...n.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(e.header,{children:(0,i.jsx)(e.h1,{id:"mongodb",children:"MongoDB"})}),"\n",(0,i.jsx)(e.h2,{id:"overview",children:"Overview"}),"\n",(0,i.jsx)(e.p,{children:"MongoDB is a document-oriented NoSQL database that stores data in flexible JSON-like documents. It's ideal for storing variable schema data in MLOps platforms."}),"\n",(0,i.jsx)(e.h2,{id:"key-features",children:"Key Features"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"Flexible Schema"})," - Documents can have different structures"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"Horizontal Scaling"})," - Sharding for distributing data"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"Indexing"})," - Fast queries on any field"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"Aggregation Pipeline"})," - Complex data transformation"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"Transactions"})," - ACID transactions since v4.0"]}),"\n"]}),"\n",(0,i.jsx)(e.h2,{id:"use-cases-in-mlops",children:"Use Cases in MLOps"}),"\n",(0,i.jsx)(e.h3,{id:"flexible-experiment-metadata",children:"Flexible Experiment Metadata"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",children:"from pymongo import MongoClient\r\n\r\nclient = MongoClient('mongodb://localhost:27017/')\r\ndb = client['mlops']\r\nexperiments = db['experiments']\r\n\r\n# Store experiments with flexible schema\r\nexperiment = {\r\n    'name': 'bert-classifier',\r\n    'version': 'v1.0',\r\n    'config': {\r\n        'batch_size': 32,\r\n        'learning_rate': 0.001,\r\n        'architecture': 'transformer',\r\n        'layers': 12,\r\n        'hidden_size': 768,\r\n        'custom_param_1': 'value1',\r\n        'custom_param_2': 42\r\n    },\r\n    'tags': ['nlp', 'classification'],\r\n    'created_at': datetime.now(),\r\n    'status': 'completed'\r\n}\r\n\r\nresult = experiments.insert_one(experiment)\n"})}),"\n",(0,i.jsx)(e.h2,{id:"installation",children:"Installation"}),"\n",(0,i.jsx)(e.h3,{id:"docker",children:"Docker"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-yaml",children:'mongodb:\r\n  image: mongo:5.0\r\n  environment:\r\n    MONGO_INITDB_ROOT_USERNAME: admin\r\n    MONGO_INITDB_ROOT_PASSWORD: password\r\n  ports:\r\n    - "27017:27017"\r\n  volumes:\r\n    - mongodb_data:/data/db\n'})}),"\n",(0,i.jsx)(e.h2,{id:"basic-operations",children:"Basic Operations"}),"\n",(0,i.jsx)(e.h3,{id:"crud-operations",children:"CRUD Operations"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",children:"from pymongo import MongoClient\r\nfrom datetime import datetime\r\n\r\nclient = MongoClient('mongodb://localhost:27017/')\r\ndb = client['mlops']\r\nruns = db['runs']\r\n\r\n# Create\r\nrun = {\r\n    'run_id': 'run_123',\r\n    'experiment_id': 'exp_1',\r\n    'status': 'completed',\r\n    'metrics': {\r\n        'accuracy': 0.95,\r\n        'loss': 0.05\r\n    },\r\n    'created_at': datetime.now()\r\n}\r\nresult = runs.insert_one(run)\r\n\r\n# Read\r\nrun = runs.find_one({'run_id': 'run_123'})\r\n\r\n# Update\r\nruns.update_one(\r\n    {'run_id': 'run_123'},\r\n    {'$set': {'status': 'archived', 'updated_at': datetime.now()}}\r\n)\r\n\r\n# Delete\r\nruns.delete_one({'run_id': 'run_123'})\n"})}),"\n",(0,i.jsx)(e.h2,{id:"indexing",children:"Indexing"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",children:"# Create indexes for performance\r\nruns.create_index('run_id')\r\nruns.create_index('experiment_id')\r\nruns.create_index('status')\r\n\r\n# Compound index\r\nruns.create_index([('experiment_id', 1), ('created_at', -1)])\r\n\r\n# Text index\r\nexperiments.create_index([('name', 'text'), ('description', 'text')])\r\n\r\n# List indexes\r\nprint(runs.list_indexes())\n"})}),"\n",(0,i.jsx)(e.h2,{id:"aggregation-pipeline",children:"Aggregation Pipeline"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",children:"# Complex aggregation\r\npipeline = [\r\n    {'$match': {'status': 'completed'}},\r\n    {'$group': {\r\n        '_id': '$experiment_id',\r\n        'avg_accuracy': {'$avg': '$metrics.accuracy'},\r\n        'count': {'$sum': 1}\r\n    }},\r\n    {'$sort': {'avg_accuracy': -1}},\r\n    {'$limit': 10}\r\n]\r\n\r\nresults = list(runs.aggregate(pipeline))\n"})}),"\n",(0,i.jsx)(e.h2,{id:"transactions",children:"Transactions"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",children:"from pymongo import MongoClient\r\nfrom pymongo.errors import OperationFailure\r\n\r\nclient = MongoClient('mongodb://localhost:27017/')\r\n\r\nwith client.start_session() as session:\r\n    with session.start_transaction():\r\n        try:\r\n            experiments.insert_one({'name': 'exp1'}, session=session)\r\n            runs.insert_one({'experiment_id': 'exp1'}, session=session)\r\n            # If we reach here, transaction commits\r\n        except OperationFailure:\r\n            # Transaction rolls back on error\r\n            raise\n"})}),"\n",(0,i.jsx)(e.h2,{id:"monitoring",children:"Monitoring"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",children:"# Connection health check\r\ndef check_mongodb_health():\r\n    try:\r\n        client = MongoClient('mongodb://localhost:27017/', serverSelectionTimeoutMS=5000)\r\n        client.admin.command('ping')\r\n        return True\r\n    except Exception as e:\r\n        print(f\"MongoDB health check failed: {e}\")\r\n        return False\r\n\r\n# Get server stats\r\nstats = db.command('dbStats')\r\nprint(f\"Database size: {stats['dataSize']} bytes\")\r\nprint(f\"Number of collections: {stats['collections']}\")\r\n\r\n# Get collection stats\r\ncol_stats = db.command('collStats', 'runs')\r\nprint(f\"Document count: {col_stats['count']}\")\r\nprint(f\"Average document size: {col_stats['avgObjSize']} bytes\")\n"})}),"\n",(0,i.jsx)(e.h2,{id:"backup-and-recovery",children:"Backup and Recovery"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bash",children:'# Backup\r\nmongodump --uri "mongodb://admin:password@localhost:27017" \\\r\n  --out /backups/mlops_backup\r\n\r\n# Restore\r\nmongorestore --uri "mongodb://admin:password@localhost:27017" \\\r\n  /backups/mlops_backup\r\n\r\n# Backup specific database\r\nmongodump --uri "mongodb://admin:password@localhost:27017/mlops" \\\r\n  --out /backups/mlops_db\r\n\r\n# Backup with compression\r\nmongodump --uri "mongodb://admin:password@localhost:27017" \\\r\n  --archive=/backups/mlops_backup.archive --gzip\n'})}),"\n",(0,i.jsx)(e.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"Use ObjectId"})," - Let MongoDB generate unique IDs"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"Avoid unbounded arrays"})," - Can cause memory issues"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"Index strategically"})," - Only index frequently queried fields"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"Use aggregation pipeline"})," - Instead of client-side processing"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"Connection pooling"})," - Reuse connections"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"Monitor disk usage"})," - Prevent unexpected full disk"]}),"\n"]}),"\n",(0,i.jsx)(e.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bash",children:'# Check MongoDB logs\r\ntail -f /var/log/mongodb/mongod.log\r\n\r\n# Connect to MongoDB CLI\r\nmongosh "mongodb://admin:password@localhost:27017"\r\n\r\n# Check database size\r\ndb.stats()\r\n\r\n# Kill slow operations\r\ndb.currentOp()\r\ndb.killOp(<opid>)\n'})}),"\n",(0,i.jsx)(e.h2,{id:"further-reading",children:"Further Reading"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.a,{href:"https://docs.mongodb.com/",children:"MongoDB Official Documentation"})}),"\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.a,{href:"https://docs.mongodb.com/manual/aggregation/",children:"MongoDB Aggregation Framework"})}),"\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.a,{href:"https://docs.mongodb.com/manual/transactions/",children:"MongoDB Transactions"})}),"\n"]})]})}function u(n={}){const{wrapper:e}={...(0,o.R)(),...n.components};return e?(0,i.jsx)(e,{...n,children:(0,i.jsx)(d,{...n})}):d(n)}},8453:function(n,e,r){r.d(e,{R:function(){return t},x:function(){return a}});var s=r(6540);const i={},o=s.createContext(i);function t(n){const e=s.useContext(o);return s.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function a(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(i):n.components||i:t(n.components),s.createElement(o.Provider,{value:e},n.children)}}}]);